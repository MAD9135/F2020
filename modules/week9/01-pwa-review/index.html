<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>9.1 Review of Progressive Web Apps (PWA) | MAD9135</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="HTML5 App Development">
    <link rel="preload" href="/F2020/assets/css/0.styles.cc1da3e7.css" as="style"><link rel="preload" href="/F2020/assets/js/app.71c50f4b.js" as="script"><link rel="preload" href="/F2020/assets/js/2.ad437195.js" as="script"><link rel="preload" href="/F2020/assets/js/73.de491df5.js" as="script"><link rel="preload" href="/F2020/assets/js/6.2620568a.js" as="script"><link rel="prefetch" href="/F2020/assets/js/10.c2d815ec.js"><link rel="prefetch" href="/F2020/assets/js/11.02a0369f.js"><link rel="prefetch" href="/F2020/assets/js/12.3bf04f72.js"><link rel="prefetch" href="/F2020/assets/js/13.1c6e5c32.js"><link rel="prefetch" href="/F2020/assets/js/14.5d381c06.js"><link rel="prefetch" href="/F2020/assets/js/15.719e0a65.js"><link rel="prefetch" href="/F2020/assets/js/16.4f84fc00.js"><link rel="prefetch" href="/F2020/assets/js/17.02eb0c88.js"><link rel="prefetch" href="/F2020/assets/js/18.1b02271c.js"><link rel="prefetch" href="/F2020/assets/js/19.09648475.js"><link rel="prefetch" href="/F2020/assets/js/20.87442cf4.js"><link rel="prefetch" href="/F2020/assets/js/21.6acc8fc8.js"><link rel="prefetch" href="/F2020/assets/js/22.5bbfc680.js"><link rel="prefetch" href="/F2020/assets/js/23.8c578ce5.js"><link rel="prefetch" href="/F2020/assets/js/24.cb7a00dd.js"><link rel="prefetch" href="/F2020/assets/js/25.cbff6da5.js"><link rel="prefetch" href="/F2020/assets/js/26.c16a249a.js"><link rel="prefetch" href="/F2020/assets/js/27.167b7c92.js"><link rel="prefetch" href="/F2020/assets/js/28.0eda0394.js"><link rel="prefetch" href="/F2020/assets/js/29.451391d8.js"><link rel="prefetch" href="/F2020/assets/js/3.b1fd2577.js"><link rel="prefetch" href="/F2020/assets/js/30.b13b96b7.js"><link rel="prefetch" href="/F2020/assets/js/31.1c4f6cb4.js"><link rel="prefetch" href="/F2020/assets/js/32.b4b69cff.js"><link rel="prefetch" href="/F2020/assets/js/33.739c7797.js"><link rel="prefetch" href="/F2020/assets/js/34.03aed1d9.js"><link rel="prefetch" href="/F2020/assets/js/35.85081de8.js"><link rel="prefetch" href="/F2020/assets/js/36.22504173.js"><link rel="prefetch" href="/F2020/assets/js/37.9d876e07.js"><link rel="prefetch" href="/F2020/assets/js/38.eeda1499.js"><link rel="prefetch" href="/F2020/assets/js/39.11489612.js"><link rel="prefetch" href="/F2020/assets/js/4.cc77419a.js"><link rel="prefetch" href="/F2020/assets/js/40.cffceb2a.js"><link rel="prefetch" href="/F2020/assets/js/41.bd24dd52.js"><link rel="prefetch" href="/F2020/assets/js/42.00c7d473.js"><link rel="prefetch" href="/F2020/assets/js/43.cdd77206.js"><link rel="prefetch" href="/F2020/assets/js/44.98bddbe7.js"><link rel="prefetch" href="/F2020/assets/js/45.5490fcb1.js"><link rel="prefetch" href="/F2020/assets/js/46.37e77bac.js"><link rel="prefetch" href="/F2020/assets/js/47.f0e1e7ad.js"><link rel="prefetch" href="/F2020/assets/js/48.5b6b9e75.js"><link rel="prefetch" href="/F2020/assets/js/49.818493e4.js"><link rel="prefetch" href="/F2020/assets/js/5.722d8314.js"><link rel="prefetch" href="/F2020/assets/js/50.f9160a1e.js"><link rel="prefetch" href="/F2020/assets/js/51.23445ddd.js"><link rel="prefetch" href="/F2020/assets/js/52.74b403b6.js"><link rel="prefetch" href="/F2020/assets/js/53.59821ac2.js"><link rel="prefetch" href="/F2020/assets/js/54.44362052.js"><link rel="prefetch" href="/F2020/assets/js/55.d6947e6e.js"><link rel="prefetch" href="/F2020/assets/js/56.fd062c7c.js"><link rel="prefetch" href="/F2020/assets/js/57.bdca367e.js"><link rel="prefetch" href="/F2020/assets/js/58.90d58982.js"><link rel="prefetch" href="/F2020/assets/js/59.1a925b68.js"><link rel="prefetch" href="/F2020/assets/js/60.2b1d5330.js"><link rel="prefetch" href="/F2020/assets/js/61.f566edd7.js"><link rel="prefetch" href="/F2020/assets/js/62.f836ae34.js"><link rel="prefetch" href="/F2020/assets/js/63.f34d8438.js"><link rel="prefetch" href="/F2020/assets/js/64.be26bf42.js"><link rel="prefetch" href="/F2020/assets/js/65.5b33fabd.js"><link rel="prefetch" href="/F2020/assets/js/66.38722f0c.js"><link rel="prefetch" href="/F2020/assets/js/67.bc61efe9.js"><link rel="prefetch" href="/F2020/assets/js/68.3cf6e246.js"><link rel="prefetch" href="/F2020/assets/js/69.8fd9a7bb.js"><link rel="prefetch" href="/F2020/assets/js/7.549e4e32.js"><link rel="prefetch" href="/F2020/assets/js/70.b41f8caf.js"><link rel="prefetch" href="/F2020/assets/js/71.a96d1c60.js"><link rel="prefetch" href="/F2020/assets/js/72.04d70935.js"><link rel="prefetch" href="/F2020/assets/js/74.e5ee8a9e.js"><link rel="prefetch" href="/F2020/assets/js/75.6d2e2098.js"><link rel="prefetch" href="/F2020/assets/js/76.26d3e621.js"><link rel="prefetch" href="/F2020/assets/js/77.5522d813.js"><link rel="prefetch" href="/F2020/assets/js/78.660d4301.js"><link rel="prefetch" href="/F2020/assets/js/79.e34d1770.js"><link rel="prefetch" href="/F2020/assets/js/8.cd8d51b1.js"><link rel="prefetch" href="/F2020/assets/js/9.a7d15d43.js">
    <link rel="stylesheet" href="/F2020/assets/css/0.styles.cc1da3e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/F2020/" class="home-link router-link-active"><!----> <span class="site-name">MAD9135</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/F2020/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2020/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/F2020/deliverables/" class="nav-link">
  Assignments
</a></div><div class="nav-item"><a href="/F2020/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/F2020/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/F2020/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/F2020/deliverables/" class="nav-link">
  Assignments
</a></div><div class="nav-item"><a href="/F2020/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/F2020/modules/week1/01-javascript-review/" class="sidebar-link">1.1 JavaScript Review</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/F2020/modules/week1/02-dom-apis/" class="sidebar-heading clickable"><span>1.2 DOM APIs Review</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/F2020/modules/week2/01-data-structures/" class="sidebar-link">2.1 JavaScript Data Types</a></li><li><a href="/F2020/modules/week2/02-modules-promises/" class="sidebar-link">2.2 Modules and Promises</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/F2020/modules/week3/01-what-is-react/" class="sidebar-heading clickable"><span>3.1 What is React?</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/F2020/modules/week3/02-react-tooling/" class="sidebar-heading clickable"><span>3.2 React Tooling</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/F2020/modules/week4/01-components-props/" class="sidebar-link">4.1 Components &amp; Props</a></li><li><a href="/F2020/modules/week4/02-component-state/" class="sidebar-link">4.2 State Management</a></li><li><a href="/F2020/modules/week5/01-hooks-weather/" class="sidebar-link">5.1 Hooks: State &amp; AJAX</a></li><li><a href="/F2020/modules/week5/02-react-router/" class="sidebar-link">5.2 Navigation</a></li><li><a href="/F2020/modules/week6/01-context/" class="sidebar-link">6.1 React Context</a></li><li><a href="/F2020/modules/week6/02-production-deployment/" class="sidebar-link">6.2 Production Deployment</a></li><li><a href="/F2020/" aria-current="page" class="sidebar-link">7.1 Forms &amp; Animation</a></li><li><a href="/F2020/" aria-current="page" class="sidebar-link">7.2 Styling</a></li><li><a href="/F2020/modules/break-week/" class="sidebar-link">Break Week</a></li><li><a href="/F2020/modules/week8/01-react-design-patterns/" class="sidebar-link">8.1 Advance Features</a></li><li><a href="/F2020/modules/week8/02-working-in-teams/" class="sidebar-link">8.2 Working in teams</a></li><li><a href="/F2020/modules/week9/01-pwa-review/" aria-current="page" class="active sidebar-link">9.1 PWA Review</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/F2020/modules/week9/01-pwa-review/#what-is-a-progressive-web-app" class="sidebar-link">What is a Progressive Web App?</a></li><li class="sidebar-sub-header"><a href="/F2020/modules/week9/01-pwa-review/#service-workers" class="sidebar-link">Service Workers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/F2020/modules/week9/01-pwa-review/#how-to-register-a-service-worker" class="sidebar-link">How to register a Service Worker</a></li><li class="sidebar-sub-header"><a href="/F2020/modules/week9/01-pwa-review/#create-a-manifest-json-file" class="sidebar-link">Create a manifest.json File</a></li><li class="sidebar-sub-header"><a href="/F2020/modules/week9/01-pwa-review/#sample-service-worker-scripts" class="sidebar-link">Sample Service Worker Scripts</a></li></ul></li><li class="sidebar-sub-header"><a href="/F2020/modules/week9/01-pwa-review/#workbox-library" class="sidebar-link">WorkBox Library</a></li></ul></li><li><a href="/F2020/modules/week9/02-react-pwa/" class="sidebar-link">9.2 PWAs with React</a></li><li><a href="/F2020/modules/week10/01-hello-react-native/" class="sidebar-link">10.1 React Native with Expo</a></li><li><a href="/F2020/modules/week10/02-the-same-but-different/" class="sidebar-link">10.2 What's Different</a></li><li><a href="/F2020/modules/week11/01-layout-navigation/" class="sidebar-link">11.1 Layout &amp; Navigation</a></li><li><a href="/F2020/modules/week11/02-nested-navigation/" class="sidebar-link">11.2 Nested Navigation</a></li><li><a href="/F2020/modules/week12/01-component-libraries/" class="sidebar-link">12.1 React Native Components</a></li><li><a href="/F2020/modules/week12/02-context-themes/" class="sidebar-link">12.2 React Native Styling</a></li><li><a href="/F2020/" aria-current="page" class="sidebar-link">13.1 Remote Data</a></li><li><a href="/F2020/" aria-current="page" class="sidebar-link">13.2 Production Deployment</a></li><li><a href="/F2020/" aria-current="page" class="sidebar-link">14.1 Final Projects</a></li><li><a href="/F2020/" aria-current="page" class="sidebar-link">14.2 Final Projects</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/F2020/deliverables/" class="sidebar-heading clickable"><span>Deliverables</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title">
    
  </div> <h1>9.1 Review of Progressive Web Apps (PWA)</h1></header> <h2 id="what-is-a-progressive-web-app"><a href="#what-is-a-progressive-web-app" class="header-anchor">#</a> What is a Progressive Web App?</h2> <ul><li><a href="https://developers.google.com/web/ilt/pwa/" target="_blank" rel="noopener noreferrer">Google Official PWA Training site<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>Progressive Enhancement</strong> means that it works on any browser. The features just improve with the newer browsers.</li> <li><strong>Responsive</strong> works on desktop, tablets and mobile.</li> <li><strong>Service Workers</strong> mean it works online, offline, or with poor connectivity</li> <li><strong>HTTPS</strong> always used</li> <li><strong>Discoverable</strong> means that search engines recognize it as an application due to W3C manifest and service worker registration.</li> <li>Support for <strong>push notifications</strong> means better user engagement.</li> <li><strong>Installable</strong> on the home screen of mobile devices</li> <li><strong>Shareable</strong> via URL instead of through app stores.</li></ul> <div class="custom-block warning"><p class="custom-block-title">Watch these talks</p> <ul><li>Great introduction to PWAs by Jake Archibald from Google <a href="https://www.youtube.com/watch?v=cmGr0RszHc8" target="_blank" rel="noopener noreferrer">Video Link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Recent talk about PWAs by Simon MacDonald (from Ottawa) <a href="https://www.youtube.com/watch?v=2kv9tH_IYtQ" target="_blank" rel="noopener noreferrer">Video Link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>FREE Udacity course by Jake Archibald on <a href="https://www.udacity.com/course/offline-web-applications--ud899" target="_blank" rel="noopener noreferrer">Creating Offline Apps<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <h2 id="service-workers"><a href="#service-workers" class="header-anchor">#</a> Service Workers</h2> <ul><li>Service workers are external scripts that can be registered to run on another thread (in the background) and that can communicate with your webpage through event listeners.</li> <li>The most common use of service workers is to be enabled through a <code>manifest.json</code> file and to cache files so a web app can run off-line or during times of poor connection.</li></ul> <h3 id="how-to-register-a-service-worker"><a href="#how-to-register-a-service-worker" class="header-anchor">#</a> How to register a Service Worker</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'serviceWorker'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Use the window load event as a trigger to register your Service Worker</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'./sw.js'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>This script assumes that you called your file <code>sw.js</code> and that it is in the same folder.</li></ul> <h3 id="create-a-manifest-json-file"><a href="#create-a-manifest-json-file" class="header-anchor">#</a> Create a manifest.json File</h3> <ul><li>In your HTML file, create a link that connects to the manifest file.</li> <li>Including this link can automatically prompt a user to add the website to their homescreen.</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>manifest<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./manifest.json<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>We never want to ask the user to install as soon as they arrive at the site.</p></div> <ul><li>Here is a script that will intercept that event and store it so we can call the prompt later on.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> installPromptEvent<span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'beforeinstallprompt'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ev<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//don't force the user to think `why would I ever do that?`</span>
    installPromptEvent <span class="token operator">=</span> ev<span class="token punctuation">;</span>  <span class="token comment">//save it for later</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">callInstallPrompt</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//call this on a button click or after a delay from your web app</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> installPromptEvent <span class="token operator">!==</span><span class="token operator">=</span> <span class="token keyword">undefined</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        installPromptEvent<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>In the mainfest.json file (similar to a package.json) we would have most of the following.</li> <li>This is a sample version of a manifest.json file</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;short_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My App&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Longer version of App Name&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;icons&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;src&quot;</span><span class="token operator">:</span><span class="token string">&quot;icon-48.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token string">&quot;48x48&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;src&quot;</span><span class="token operator">:</span><span class="token string">&quot;icon-96.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token string">&quot;96x96&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;src&quot;</span><span class="token operator">:</span><span class="token string">&quot;icon-192.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192x192&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;src&quot;</span><span class="token operator">:</span><span class="token string">&quot;icon-512.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token string">&quot;512x512&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;start_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.html?launcher=true&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;display&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standalone&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;background_color&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#E4E4E4&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;theme_color&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#BADA55&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;This is the description of my PWA&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>For <code>display</code> we can use <code>standalone</code>: URL bar disappears, <code>fullscreen</code>: URL bar and status bar disappear, <code>minimal-ui</code>: minor changes, <code>browser</code>: looks like every other webpage... so, why?</li> <li><code>standalone</code> is the recommended choice for PWAs.</li> <li>If you want to have Javascript that does something if the app loads like an web app instead of a web page then you can use this:</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(display-mode: standalone)'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//we loaded the page as a PWA, not a normal boring webpage</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">//boring webpage</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="sample-service-worker-scripts"><a href="#sample-service-worker-scripts" class="header-anchor">#</a> Sample Service Worker Scripts</h3> <ul><li>Once you have your <code>&lt;link&gt;</code>, your <code>manifest.json</code> file, and you have registered your Service Worker script then it is time to add something to that file.</li> <li>Every thing that you want to cache needs to be grouped together in a CacheStorage object, which needs a name and an array of filenames.</li> <li>Do this at the top of the <code>sw.js</code> file.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">CACHE_VERSION</span> <span class="token operator">=</span> <span class="token string">'v1.7'</span>
<span class="token keyword">const</span> <span class="token constant">CACHE_LIST</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'favicon.ico'</span><span class="token punctuation">,</span>
  <span class="token string">'index.html'</span><span class="token punctuation">,</span>
  <span class="token string">'main.js'</span><span class="token punctuation">,</span>
  <span class="token string">'img/200.jpeg'</span><span class="token punctuation">,</span>
  <span class="token string">'img/404.jpeg'</span>
<span class="token punctuation">]</span>
</code></pre></div><ul><li>Think of these as a pair that stays together.</li> <li>Then the Service Worker has various event listeners that run at different times.</li> <li>There is an install phase that happens when your main script registers the service worker file.</li> <li>This will trigger the <code>install</code> event.</li> <li>The second phase is the <code>activate</code> phase where the Service Worker starts to run and do its work.</li> <li>The third phase happens each time the browser tries to load a file. There is a <code>fetch</code> event that happens for every file.</li> <li>The Service Worker will be intercepting these fetch calls and deciding where to get the file from the cache, or the network, or both.</li> <li>Here is a sample script showing a script running at each event.</li></ul> <p><strong>INSTALL PHASE</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'install'</span><span class="token punctuation">,</span> <span class="token parameter">ev</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//step one... initial install</span>

  <span class="token comment">//get all the cacheStorage objects</span>
  <span class="token comment">//try to open a specific version</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'installing the cache'</span><span class="token punctuation">)</span>
  ev<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
    caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token constant">CACHE_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">cache</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//install all the files in that cache</span>
      <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token constant">CACHE_LIST</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>ACTIVATE PHASE</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token parameter">ev</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//step two... activate the service worker</span>
  <span class="token comment">//make a list of which cache versions are ok</span>
  <span class="token comment">//it is a list because you could have different caches for different file types, etc.</span>
  <span class="token keyword">const</span> cacheWhiteList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'v1.7'</span><span class="token punctuation">]</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'activating the cache'</span><span class="token punctuation">)</span>

  <span class="token comment">//get the list of all the cacheStorage keys</span>
  ev<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
    caches<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">keys</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//run this function once you have a list of current cache version keys</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
        keys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">//test all the keys in the array</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cacheWhiteList<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//remove caches if they are not in the whitelist</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'remove cache'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>
            <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'got cache'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>FETCH PHASE</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'fetch'</span><span class="token punctuation">,</span> <span class="token parameter">ev</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//step three... handle all the requests from the browser</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'handling fetch from browser for'</span><span class="token punctuation">,</span> ev<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span>

  ev<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span>
    caches
      <span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>request<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Found'</span><span class="token punctuation">,</span> response<span class="token punctuation">,</span> <span class="token string">'in cache'</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> response <span class="token comment">//back to the browser from the cache</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>request<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
          <span class="token string">'No response match found in cache. Go to the network for'</span><span class="token punctuation">,</span>
          ev<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url
        <span class="token punctuation">)</span>
        <span class="token keyword">var</span> fetchRequest <span class="token operator">=</span> ev<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">//go to the network</span>
        <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resp</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">//if you want to save all fetched files to the cache</span>
          <span class="token keyword">let</span> responseStreamToCache <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token constant">CACHE_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//cache the response for the next visit</span>
            <span class="token comment">//cache.put(ev.request, responseStreamToCache);</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">//return what came back from the network</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resp <span class="token operator">||</span> resp<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">200</span> <span class="token operator">||</span> resp<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'basic'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> resp
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">//failed to get from the network</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>request<span class="token punctuation">.</span>destination <span class="token operator">===</span> <span class="token string">'image'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">//send back a cached image for non-cached images</span>
              <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'img/404.jpeg'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// If both fail, show a generic fallback:</span>
        <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">'/offline.html'</span><span class="token punctuation">)</span>
        <span class="token comment">// However, in reality you'd have many different</span>
        <span class="token comment">// fallbacks, depending on URL &amp; headers.</span>
        <span class="token comment">// Eg, a fallback silhouette image for avatars.</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>You can see that even this simple example has a LOT of boilerplate code to handle a few files and requests.</li> <li>There are also other events that can happen in the third phase after the service worker has been activated.</li> <li>These other events include <code>sync</code>, <code>push</code>, <code>message</code>, and <code>statechange</code>.</li> <li>Initial <strong>LIMITED</strong> support for manifest.json files was added in iOS 11.3.</li></ul> <div class="custom-block danger"><p class="custom-block-title">iOS Warning</p> <p>Apple has done a terrible job of staying up to date with PWA technology. e.g.</p> <ul><li>iOS 11 and iOS 12 both lack support for many of the features of PWAs.</li> <li>iOS 11.3 still looks for a series of meta tags to let users add webpages to their home screen.</li> <li>iOS 12.1 still fails to let PWAs access file inputs, the camera, or getUserMedia, no support for push notifications or background sync, plus it will remove any Service Workers and cached files after a couple weeks.</li></ul> <p><strong>See this summary of the <a href="https://goulet.dev/posts/ios14-pwa-improvements/" target="_blank" rel="noopener noreferrer">latest changes for iOS 14 PWA support<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</strong></p></div> <h2 id="workbox-library"><a href="#workbox-library" class="header-anchor">#</a> WorkBox Library</h2> <p>Google has created a library that reduces the amount of boilerplate code you will need to create a Service Worker that handles the caching of files.</p> <ul><li><a href="https://developers.google.com/web/tools/workbox/" target="_blank" rel="noopener noreferrer">WorkBox<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://developers.google.com/web/tools/workbox/guides/get-started" target="_blank" rel="noopener noreferrer">WorkBox Guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Great <a href="https://medium.com/google-developer-experts/a-5-minute-intro-to-workbox-3-0-156803952b3e" target="_blank" rel="noopener noreferrer">WorkBox Tutorial<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: :</span> <span class="time">11/11/2020, 11:47:59 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/F2020/modules/week8/02-working-in-teams/" class="prev">
        8.2 Working in teams
      </a></span> <span class="next"><a href="/F2020/modules/week9/02-react-pwa/">
        9.2 PWAs with React
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/F2020/assets/js/app.71c50f4b.js" defer></script><script src="/F2020/assets/js/2.ad437195.js" defer></script><script src="/F2020/assets/js/73.de491df5.js" defer></script><script src="/F2020/assets/js/6.2620568a.js" defer></script>
  </body>
</html>
